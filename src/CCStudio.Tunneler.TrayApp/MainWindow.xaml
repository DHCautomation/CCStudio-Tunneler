<Window x:Class="CCStudio.Tunneler.TrayApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        Title="CCStudio-Tunneler"
        Height="1"
        Width="1"
        WindowStyle="None"
        ShowInTaskbar="False"
        Visibility="Hidden"
        ResizeMode="NoResize">

    <Window.Resources>
        <!-- Context Menu for System Tray -->
        <ContextMenu x:Key="TrayContextMenu">
            <MenuItem Header="Configure..." Click="OnConfigure" FontWeight="Bold">
                <MenuItem.Icon>
                    <Image Source="Resources/Icon.png" Width="16" Height="16"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="View Status" Click="OnViewStatus">
                <MenuItem.Icon>
                    <TextBlock Text="ðŸ“Š" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem Header="Service">
                <MenuItem Header="Start Service" Name="MenuStartService" Click="OnStartService">
                    <MenuItem.Icon>
                        <TextBlock Text="â–¶" FontSize="14" Foreground="Green"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Stop Service" Name="MenuStopService" Click="OnStopService">
                    <MenuItem.Icon>
                        <TextBlock Text="â¹" FontSize="14" Foreground="Red"/>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Restart Service" Name="MenuRestartService" Click="OnRestartService">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸ”„" FontSize="14" Foreground="Orange"/>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <Separator/>
            <MenuItem Header="View Logs" Click="OnViewLogs">
                <MenuItem.Icon>
                    <TextBlock Text="ðŸ“" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="Open Config Folder" Click="OnOpenConfigFolder">
                <MenuItem.Icon>
                    <TextBlock Text="ðŸ“" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem Header="About" Click="OnAbout">
                <MenuItem.Icon>
                    <TextBlock Text="â„¹" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem Header="Exit" Click="OnExit">
                <MenuItem.Icon>
                    <TextBlock Text="âœ–" FontSize="14" Foreground="Red"/>
                </MenuItem.Icon>
            </MenuItem>
        </ContextMenu>
    </Window.Resources>

    <!-- System Tray Icon -->
    <Grid>
        <tb:TaskbarIcon x:Name="TrayIcon"
                        IconSource="Resources/Icon.png"
                        ToolTipText="CCStudio-Tunneler - OPC DA to OPC UA Bridge"
                        ContextMenu="{StaticResource TrayContextMenu}"
                        TrayLeftMouseUp="OnTrayIconLeftClick">
        </tb:TaskbarIcon>
    </Grid>
</Window>
